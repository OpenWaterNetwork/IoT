<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.73">
<link rel="alternate" type="application/rss+xml" href="/IoT/blog/rss.xml" title="OpenWaterNetwork Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/IoT/blog/atom.xml" title="OpenWaterNetwork Blog Atom Feed"><title data-react-helmet="true">Sensors and communication protocols | OpenWaterNetwork</title><meta data-react-helmet="true" property="og:url" content="https://fabianastudillo.github.io/IoT/docs/buildsensornodes/sensors-and-comm"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Sensors and communication protocols | OpenWaterNetwork"><meta data-react-helmet="true" name="description" content="Technical Characteristics"><meta data-react-helmet="true" property="og:description" content="Technical Characteristics"><link data-react-helmet="true" rel="shortcut icon" href="/IoT/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://fabianastudillo.github.io/IoT/docs/buildsensornodes/sensors-and-comm"><link data-react-helmet="true" rel="alternate" href="https://fabianastudillo.github.io/IoT/docs/buildsensornodes/sensors-and-comm" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://fabianastudillo.github.io/IoT/es/docs/buildsensornodes/sensors-and-comm" hreflang="es"><link data-react-helmet="true" rel="alternate" href="https://fabianastudillo.github.io/IoT/docs/buildsensornodes/sensors-and-comm" hreflang="x-default"><link rel="stylesheet" href="/IoT/assets/css/styles.c333a9d5.css">
<link rel="preload" href="/IoT/assets/js/styles.284837e9.js" as="script">
<link rel="preload" href="/IoT/assets/js/runtime~main.f88cf925.js" as="script">
<link rel="preload" href="/IoT/assets/js/main.3d1ecd3c.js" as="script">
<link rel="preload" href="/IoT/assets/js/1.10e6b60e.js" as="script">
<link rel="preload" href="/IoT/assets/js/2.49a454c6.js" as="script">
<link rel="preload" href="/IoT/assets/js/3.1d458317.js" as="script">
<link rel="preload" href="/IoT/assets/js/1be78505.37867c24.js" as="script">
<link rel="preload" href="/IoT/assets/js/49.f7c4dc10.js" as="script">
<link rel="preload" href="/IoT/assets/js/935f2afb.50c35842.js" as="script">
<link rel="preload" href="/IoT/assets/js/17896441.7537e30b.js" as="script">
<link rel="preload" href="/IoT/assets/js/ec2c6eb7.f1cc12e9.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/IoT/"><img src="/IoT/img/logo.svg" alt="OpenWaterNetwork" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/IoT/img/logo.svg" alt="OpenWaterNetwork" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">OpenWaterNetwork</strong></a><div class="navbar__item dropdown dropdown--hoverable dropdown--left"><a href="#" class="navbar__item navbar__link"><span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" style="vertical-align:text-bottom;margin-right:5px"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>English</span></span></a><ul class="dropdown__menu"><li><a href="/IoT/docs/buildsensornodes/sensors-and-comm" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" style="text-transform:capitalize">English</a></li><li><a href="/IoT/es/docs/buildsensornodes/sensors-and-comm" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">espaÃ±ol</a></li></ul></div><a class="navbar__item navbar__link navbar__link--active" href="/IoT/docs/intro">Tutorial</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/IoT/"><img src="/IoT/img/logo.svg" alt="OpenWaterNetwork" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/IoT/img/logo.svg" alt="OpenWaterNetwork" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">OpenWaterNetwork</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a href="#" role="button" class="menu__link menu__link--sublist"><span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" style="vertical-align:text-bottom;margin-right:5px"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>Languages</span></span></a><ul class="menu__list"><li class="menu__list-item"><a href="/IoT/docs/buildsensornodes/sensors-and-comm" target="_self" rel="noopener noreferrer" class="menu__link dropdown__link--active" style="text-transform:capitalize">English</a></li><li class="menu__list-item"><a href="/IoT/es/docs/buildsensornodes/sensors-and-comm" target="_self" rel="noopener noreferrer" class="menu__link" style="text-transform:capitalize">espaÃ±ol</a></li></ul></li><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/IoT/docs/intro">Tutorial</a></li><li class="menu__list-item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/IoT/docs/intro">Introduction</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Hands-on training on IoT for beginners</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/IoT/docs/handsontraining/module1">Module 1 - Introduction to the Internet of Things (IoT)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/IoT/docs/handsontraining/module2">Module 2 - Basic components of an IoT system</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/IoT/docs/handsontraining/module4">Module 3 - Introduction to python/Micro-python</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/IoT/docs/handsontraining/module3">Module 4 - The IoT processing unit</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/IoT/docs/handsontraining/module5">Module 5 - Building the first basic IoT system</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/IoT/docs/handsontraining/module6">Module 6 - Building an improved IoT system with more sensors</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/IoT/docs/handsontraining/module7">Module 7 - Keeping time and introducing the deep sleep concept</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/IoT/docs/handsontraining/module8">Module 8 - Building your own LoRa Gateway for data transmission</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/IoT/docs/handsontraining/module9">Module 9 - IoT Data transmission, storage,  visualization and download</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/IoT/docs/handsontraining/module10">Module 10 - Individual/group projects</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Build your own LoRa gateway</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/IoT/docs/buildloragateway/pygate">PyGate</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/IoT/docs/buildloragateway/gatewayonttn">Gateway registration on TTN</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/IoT/docs/buildloragateway/gateway">Gateway</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Build your own sensor nodes</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/IoT/docs/buildsensornodes/pcbs">Printed Circuit Boards (PCBs)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/IoT/docs/buildsensornodes/sensornodesttn">Water sensor expansion board 1.0 for LoPy4/FiPy/GPy/SiPy/WiPy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/IoT/docs/buildsensornodes/wseb">Sensor node registration on TTN</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/IoT/docs/buildsensornodes/sensors-and-comm">Sensors and communication protocols</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">ThingsBoard IoT platform </a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/IoT/docs/thingsboardiotplaftorm/topic1">Topic 1</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/IoT/docs/thingsboardiotplaftorm/topic2">Topic 2</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Sensors and communication protocols</h1></header><div class="markdown"><p>Technical Characteristics</p><p>The central processing unit of the equipment is the Lopy4 development board. The most relevant features were taken from <a href="https://docs.pycom.io/datasheets/development/lopy4/#datasheet" target="_blank" rel="noopener noreferrer">Lopy 4 datasheet</a>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="electrical"></a>Electrical<a class="hash-link" href="#electrical" title="Direct link to heading">#</a></h3><ul><li>Input voltage: 3.5 - 4.2V</li><li>Output voltage: 3.3V, 1.2 A.</li><li>Max Input sink current - GPIO: 12mA</li><li>Input leakage current: 50nA</li><li>Max Output source current: 12mA</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="cpu"></a>CPU<a class="hash-link" href="#cpu" title="Direct link to heading">#</a></h3><ul><li>XtensaÂ® dualâ€“core 32â€“bit LX6 microprocessor(s), up to 600 DMIPS</li><li>Hardware floating point acceleration</li><li>Python multiâ€“threading</li><li>An extra ULPâ€“coprocessor that can monitor GPIOs and the ADC channels and it can control most of the internal peripherals during deepâ€“sleep mode while only consuming ~25uA</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="memory"></a>Memory<a class="hash-link" href="#memory" title="Direct link to heading">#</a></h3><ul><li>RAM: 520KB + 4MB</li><li>External flash: 8MB</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="lora"></a>LoRa<a class="hash-link" href="#lora" title="Direct link to heading">#</a></h3><ul><li>Frequency Range: 137â€“1020MHz</li><li>Spreading factor: 6 â€“ 12</li><li>Effective Bitrate: 0.018 â€“ 37.5 kpbs</li><li>Sensitivity: â€“111 to â€“148 dBm</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="wifi"></a>WiFi<a class="hash-link" href="#wifi" title="Direct link to heading">#</a></h3><ul><li>802.11b/g/n 16mbps.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="bluetooth"></a>Bluetooth<a class="hash-link" href="#bluetooth" title="Direct link to heading">#</a></h3><ul><li>Low energy and classic</li><li>Compliant with Bluetooth v4.2 BR/EDR and BLE</li><li>+12 dBm transmitting power</li><li>Standard HCI based on SDIO/SPI/UART specification</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="gprs"></a>GPRS<a class="hash-link" href="#gprs" title="Direct link to heading">#</a></h3><ul><li>Supports command including 3GPP TS 27.007, 27.005 and SIMCOM enhanced AT Commands.</li><li>Working Voltage: 3.5~4.2V</li><li>Quad-band 850/900/1800/1900MHz</li><li>Send and receive GPRS data (TCP/IP, HTTP, etc.)</li><li>Low current consumption - 1mA in sleep mode.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="power-supply"></a>Power Supply<a class="hash-link" href="#power-supply" title="Direct link to heading">#</a></h3><ul><li>Lithium battery 3.7V 5000mAh. </li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="mb7388-hrxl-maxsonar-wrmlt-sensor"></a>MB7388 HRXL-MaxSonar-WRMLT Sensor<a class="hash-link" href="#mb7388-hrxl-maxsonar-wrmlt-sensor" title="Direct link to heading">#</a></h3><p>The MB7388 HRXL-MaxSonar-WRMLT sensor is a cost-effective solution for applications that requiere accurate distance detection. The main technical features are taken from <a href="https://www.maxbotix.com/documents/HRXL-MaxSonar-WR_Datasheet.pdf" target="_blank" rel="noopener noreferrer">HRXL-MaxSonar- WR Series</a>.</p><ul><li>Low cost ultrasonic rangefinder.</li><li>Detection out to 10-meters</li><li>Resolution of 1-mm</li><li>Distance sensor 50-cm to 10-meters</li><li>Operating voltage of 2.7V to 5.5V</li><li>Nominal current draw of 2.3mA (peak ~49mA) at 3.3V.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="hardware-component-description"></a>Hardware component description.<a class="hash-link" href="#hardware-component-description" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="river-level-sensor"></a>River Level Sensor<a class="hash-link" href="#river-level-sensor" title="Direct link to heading">#</a></h3><p>El hardware estÃ¡ integrado en un Placa de Circuito Impreso (PCB), el mismo tiene como componente principal el mÃ³dulo de desarrollo Lopy4, encargado de realizar las tareas de control, almacenamiento y transmisiÃ³n. </p><p>Los demÃ¡s perifericos con los que cuenta el dispositivo (RTC ds3231, FTDI Basic, DHT22 y MB7388 HRXL-MaxSonar-WRMLT sensor) estÃ¡n conectados a la mencionada Unidad Central de Procesamiento (Lopy4). </p><p>AdemÃ¡s del PCB mencionado anteriormente, el dispositivo cuenta con una bateria de Litio de 3.7V, para alimentar la placa.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="lopy4-connections"></a>Lopy4 connections.<a class="hash-link" href="#lopy4-connections" title="Direct link to heading">#</a></h4><p>La tarjeta Lopy4 cuenta con 28 pines, entre los cuales estÃ¡n los pines de alimentaciÃ³n y una salida de 3.3V, la disposiciÃ³n de los mismos podemos observar en la figura a continuaciÃ³n. TambiÃ©n se detalla la conexiÃ³n de pines con los perifericos.</p><table><thead><tr><th><img alt="fig:Lopy4pinConnections" src="/IoT/assets/images/Lopy4SCHRLS-1e9ab52bd78d0fc907b9fb200862438c.PNG"></th></tr></thead><tbody><tr><td>Lopy4 pin connections.</td></tr></tbody></table><ul><li>P0: Rx P1: Tx. ComunicaciÃ³n UART con el FTDI Basic.</li><li>P2: Pin de Arranque, para actualizar el firmware.</li><li>P3: Tx P4: Rx. ComunicaciÃ³n UART con el SIM 800L.</li><li>P8: Pin de Arranque para el SIM 800L.</li><li>P9: SDA P10: SDL. ComunicaciÃ³n I2C con el RTC ds3231.</li><li>P11: Pulse Width Output Sensor.</li><li>P12: Pin 4- Ranging Start/Stop Sensor.</li><li>P20: Pin de control de modo de funcionamieto.</li><li>P21: Pin de control de fuente de los sensores.</li><li>P22: Pin de lectura del nivel de tensiÃ³n de BaterÃ­a.</li><li>P23: Pin de lectura de seÃ±al del sensor DHT22. </li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="dht22"></a>DHT22<a class="hash-link" href="#dht22" title="Direct link to heading">#</a></h4><p>El sensor de temperatura y humedad interno, estÃ¡ conectado a un pin digital del MCU, configurado como entrada, tambiÃ©n se conecta una resistencia de pull up a la salida de la seÃ±al, ver la siguiente figura.</p><table><thead><tr><th><img alt="fig:DHT22pinconnections" src="data:image/png;base64,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"></th></tr></thead><tbody><tr><td>DHT22 pin connections.</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ftdi-basic"></a>FTDI BAsic<a class="hash-link" href="#ftdi-basic" title="Direct link to heading">#</a></h4><p>El mÃ³dulo se conecta al MCU a travÃ©s del protocolo UART y comparte la misma referencia de GND.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="rtc-ds3231"></a>RTC Ds3231<a class="hash-link" href="#rtc-ds3231" title="Direct link to heading">#</a></h4><p>EstÃ© periferico se conecta al MCU a travÃ©s del protocolo I2C, se utilizan dos resistencia de pull up en los pines de comunicaciÃ³n (ver la figura a continuaciÃ³n), ademÃ¡s cuenta con una pila pequeÃ±a que lo alimenta en caso de corte de energÃ­a.</p><table><thead><tr><th><img alt="fig:DS3231PinCon" src="/IoT/assets/images/ds3231SCH-c6b4bc4cca8ee47d6f7245f878d5c258.PNG"></th></tr></thead><tbody><tr><td>RTC DS3231 pin connections</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="mb7388-hrxl-maxsonar-wrmlt"></a>MB7388 HRXL-MaxSonar-WRMLT<a class="hash-link" href="#mb7388-hrxl-maxsonar-wrmlt" title="Direct link to heading">#</a></h4><p>El sensor estÃ¡ conectado al MCU por intermedio de los puertos GPIO digitales, para realizar la lectura y el control del mismo; utiliza dos conectores de tipo bornera para facilitar su integraciÃ³n en la placa electrÃ³nica.</p><table><thead><tr><th><img alt="fig:BornerPinCon" src="/IoT/assets/images/BornerconRLS-3c531cf811f6efd1b51fa18421e1c9f0.PNG"></th></tr></thead><tbody><tr><td>Header for MB7388 sensor pin connections.</td></tr></tbody></table><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="start-up"></a>Start-up<a class="hash-link" href="#start-up" title="Direct link to heading">#</a></h2><p>En esta secciÃ³n se presenta la puesta en marcha del dispositivo, se describe los comandos necesarios para la configuraciÃ³n. </p><p>En la siguiente figura se observa una vista 3D del dispositivo IoT LoRa Gateway con cada uno de sus componentes, que se detallan a continuaciÃ³n:</p><table><thead><tr><th><img alt="fig:RLS_3d" src="/IoT/assets/images/RiverLevelSensorDatalogger_3d_borner-cb72f352888ac5e072b4bbc713c5048b.PNG"></th></tr></thead><tbody><tr><td>IoT LoRa River Level Sensor Datalogger</td></tr></tbody></table><ul><li>U1: GPRS module SIM800L.</li><li>U2: Lopy 4.</li><li>U3: RTC DS3231.</li><li>J1: Temperature and humidity sensor DHT22.</li><li>P1: Power In connector.</li><li>H1: Jumper conector - boot mode selector.</li><li>H2: usb to serial converter.</li><li>S1: Operating mode selector button</li><li>B2: Header - Power sensor.</li><li>B1: Header - Signals sensor.</li></ul><p>Para comenzar la configuraciÃ³n del Gateway, es necesario descargar el software para gestiÃ³n y programaciÃ³n segÃºn lo indicado en la pagina de <a href="https://docs.pycom.io/gettingstarted/software/" target="_blank" rel="noopener noreferrer">Documentos de Pycom Lopy 4</a>. Se puede trabajar con las 2 opciones tanto el software &quot;ATOM&quot; como tambiÃ©n &quot;Visual Studio Code&quot;.</p><p>En caso de usar Windows es necesario descargar los drivers del conversor Usb-serial desde la pÃ¡gina de <a href="https://ftdichip.com/drivers/vcp-drivers/" target="_blank" rel="noopener noreferrer">FTDI Chip - VCP</a>, de esta manera se tiene el puerto COM correspondiente.</p><p>Una vez se han instalado los componentes de software, conecte la placa a la alimentaciÃ³n a travÃ©z de P1 y a una PC con un cable micro USB para uso de datos, a travÃ©z de P2.</p><p>La placa tiene un led que indica el arranque normal del sistema y el modo en que se encuentra funcionando. La secuencia inicia con el led de color rojo encendido por 1 segundo, lo que quiere decir que la placa entra en modo de espera (Modo de configuraciÃ³n).</p><table><thead><tr><th><img alt="fig:usbConnect" src="/IoT/assets/images/usbConnect-8bcba4b8475ef0c74d46975a0fa2eb0e.PNG"></th></tr></thead><tbody><tr><td>USB connection.</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="mododos-de-funcionamiento"></a>Mododos de funcionamiento.<a class="hash-link" href="#mododos-de-funcionamiento" title="Direct link to heading">#</a></h3><p>En el modo de configuraciÃ³n el sistema estÃ¡ a la espera de ejecutar algÃºn comando. Al cargar el software por primera vez, el sistema entrarÃ¡ en este modo y se encenderÃ¡ un LED ROJO como indicador.</p><p>El sistema realiza automÃ¡ticamente el siguiente proceso:</p><ul><li>EnvÃ­a el paquete de sincronizaciÃ³n por LoRa y espera por a respuesta del Gateway.</li><li>Si obtiene la respuesta del gateway, sincroniza el tiempo del RTC DS3231.</li><li>Si no obtiene respuesta del gateway, obtiene el tiempo del RTC DS3231.</li><li>Espera la ejecuciÃ³n del comando.</li></ul><p>Para configurar primero debemos ejecutar el siguiente comando, este se encarga de sincronizar la hora del dispositivo (NODO) con la del GAteway y actualizarla en el RTC DS3231.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python:"><div tabindex="0" class="prism-code language-python: codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">SincNodefromGateway()</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>El dispositivo debe permanecer en este modo de funcionamiento para sincronizar la hora y la fecha del nodo. Una vez sincronizado, se puede enviar los paquetes por lorawan, ejecutando los siguientes comandos:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python:"><div tabindex="0" class="prism-code language-python: codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">joinLoraWan()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">dataSendLoraWan()</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Para entrar en el modo de ejecuciÃ³n, se ejecuta el siguiente comando. </p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python:"><div tabindex="0" class="prism-code language-python: codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">runModeOutConsole()</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="run-mode---active-console"></a>Run mode - Active console.<a class="hash-link" href="#run-mode---active-console" title="Direct link to heading">#</a></h3><p>Este es el modo en el que el dispositivo permanecerÃ¡ constantemente en funcionamiento. El dispositivo realizarÃ¡ los siguientes pasos:</p><ul><li>SincronizaciÃ³n de fecha y hora, a travÃ©s del RTC DS3231.</li><li>IniciaciÃ³n de la alarma para la transmisiÃ³n de paquetes.</li><li>Se activa alarma.</li><li>Se adquiere datos de los sensores y se almacena.</li><li>Se une a la red lorawan y transmite los paquetes.</li><li>Entra en modo de reposo profundo.
</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="run-mode---inactive-console"></a>Run mode - Inactive console,<a class="hash-link" href="#run-mode---inactive-console" title="Direct link to heading">#</a></h3><p>Este es el modo en el que el dispositivo permanecerÃ¡ constantemente en funcionamiento. El dispositivo realizarÃ¡ los siguientes pasos:</p><ul><li>SincronizaciÃ³n de fecha y hora, a travÃ©s del RTC DS3231.</li><li>Desabilita la consola.</li><li>IniciaciÃ³n de la alarma para la transmisiÃ³n de paquetes.</li><li>Se activa alarma.</li><li>Se adquiere datos de los sensores y se almacena.</li><li>Se une a la red lorawan y transmite los paquetes.</li><li>Entra en modo de reposo profundo.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="mÃ©todos-de-configuraciÃ³n"></a>MÃ©todos de configuraciÃ³n.<a class="hash-link" href="#mÃ©todos-de-configuraciÃ³n" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="real-time-clock-rtc-ds3231"></a>Real time clock (RTC) ds3231<a class="hash-link" href="#real-time-clock-rtc-ds3231" title="Direct link to heading">#</a></h3><p>The external real time clock (RTC) ds3231 is the one that will keep the system synchronized in time and date, due to an independent battery. The methods for synchronization are presented below.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python:"><div tabindex="0" class="prism-code language-python: codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">ds3231.ds1307init_sinc(None)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><ul><li>Synchronizes the external real-time clock (ds3231) with the internal
time (lopy 4).</li><li>Response: (year, day, month, hour, minute, second, millisecond,
None)</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python:"><div tabindex="0" class="prism-code language-python: codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">get_time_ds3231(None)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><ul><li>Obtains the date and time from the external real-time clock
(ds3231).</li><li>Response: (year, day, month, hour, minute, second, millisecond,
None)</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python:"><div tabindex="0" class="prism-code language-python: codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">ds3231.sinc_RTC_from_ds3231(None)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><ul><li>Synchronizes the internal clock (lopy 4) with the time of the
external real-time clock (ds3231).</li><li>Response: (year, day, month, hour, minute, second, millisecond,
None)</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="temperature-and-humidity-sensor-dht11"></a>Temperature and humidity sensor DHT11<a class="hash-link" href="#temperature-and-humidity-sensor-dht11" title="Direct link to heading">#</a></h3><p>The sensor reading is carried out by the following method:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python:"><div tabindex="0" class="prism-code language-python: codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">result = th.read(None)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><ul><li>Response: result.temperature</li><li>Response: result.humidity</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="mb7388-hrxl-sensor-dht11"></a>MB7388 HRXL sensor DHT11<a class="hash-link" href="#mb7388-hrxl-sensor-dht11" title="Direct link to heading">#</a></h3><p>The sensor reading is carried out by the following method:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python:"><div tabindex="0" class="prism-code language-python: codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">    level = level_data(None)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><ul><li>Response: level</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="lorawan"></a>LoRaWan<a class="hash-link" href="#lorawan" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python:"><div tabindex="0" class="prism-code language-python: codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">    joinLoraWan() </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><ul><li>Configura los parÃ¡metros necesarios de la red LoraWan y se une al servidor.</li><li>Respuesta: joined </li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python:"><div tabindex="0" class="prism-code language-python: codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">    dataSendLoraWan() </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><ul><li>Adquiere los datos de los sensores, los almacena y los transmite por LoRaWan</li><li>Response: (dataTempInt, dataHumInt, dataLevel)</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="create-a-docs-version"></a>Create a docs version<a class="hash-link" href="#create-a-docs-version" title="Direct link to heading">#</a></h2><p>Release a version 1.0 of your project:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">npm</span><span class="token plain"> run docusaurus docs:version </span><span class="token number" style="color:rgb(247, 140, 108)">1.0</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>The <code>docs</code> folder is copied into <code>versioned_docs/version-1.0</code> and <code>versions.json</code> is created.</p><p>Your docs now has 2 versions:</p><ul><li><code>1.0</code> at <code>http://localhost:3000/docs/</code> for the version 1.0 docs</li><li><code>current</code> at <code>http://localhost:3000/docs/next/</code> for the <strong>upcoming, unreleased docs</strong></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="add-a-version-dropdown"></a>Add a Version Dropdown<a class="hash-link" href="#add-a-version-dropdown" title="Direct link to heading">#</a></h2><p>To navigate smoothly across versions, add a version dropdown.</p><p>Modify the <code>docusaurus.config.js</code> file:</p><div class="codeBlockContainer_K1bP"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_eoMF">docusaurus.config.js</div><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar codeBlockWithTitle_2JqI"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">module</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  themeConfig</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    navbar</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      items</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">          type</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;docsVersionDropdown&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>The docs version dropdown appears in your navbar:</p><p><img alt="Docs Version Dropdown" src="/IoT/assets/images/docsVersionDropdown-dda80f009a926fb2dd92bab8faa6c4d8.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="update-an-existing-version"></a>Update an existing version<a class="hash-link" href="#update-an-existing-version" title="Direct link to heading">#</a></h2><p>It is possible to edit versioned docs in their own folder:</p><ul><li><code>versioned_docs/version-1.0/hello.md</code> updates <code>http://localhost:3000/docs/hello</code></li><li><code>docs/hello.md</code> updates <code>http://localhost:3000/docs/next/hello</code></li></ul></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/OpenWaterNetwork/IoT/blob/documentation/docs/buildsensornodes/sensors-and-comm.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/IoT/docs/buildsensornodes/wseb"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Sensor node registration on TTN</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/IoT/docs/thingsboardiotplaftorm/topic1"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Topic 1 Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#electrical" class="table-of-contents__link">Electrical</a></li><li><a href="#cpu" class="table-of-contents__link">CPU</a></li><li><a href="#memory" class="table-of-contents__link">Memory</a></li><li><a href="#lora" class="table-of-contents__link">LoRa</a></li><li><a href="#wifi" class="table-of-contents__link">WiFi</a></li><li><a href="#bluetooth" class="table-of-contents__link">Bluetooth</a></li><li><a href="#gprs" class="table-of-contents__link">GPRS</a></li><li><a href="#power-supply" class="table-of-contents__link">Power Supply</a></li><li><a href="#mb7388-hrxl-maxsonar-wrmlt-sensor" class="table-of-contents__link">MB7388 HRXL-MaxSonar-WRMLT Sensor</a></li><li><a href="#hardware-component-description" class="table-of-contents__link">Hardware component description.</a><ul><li><a href="#river-level-sensor" class="table-of-contents__link">River Level Sensor</a></li></ul></li><li><a href="#start-up" class="table-of-contents__link">Start-up</a><ul><li><a href="#mododos-de-funcionamiento" class="table-of-contents__link">Mododos de funcionamiento.</a></li><li><a href="#run-mode---active-console" class="table-of-contents__link">Run mode - Active console.</a></li><li><a href="#run-mode---inactive-console" class="table-of-contents__link">Run mode - Inactive console,</a></li></ul></li><li><a href="#mÃ©todos-de-configuraciÃ³n" class="table-of-contents__link">MÃ©todos de configuraciÃ³n.</a><ul><li><a href="#real-time-clock-rtc-ds3231" class="table-of-contents__link">Real time clock (RTC) ds3231</a></li><li><a href="#temperature-and-humidity-sensor-dht11" class="table-of-contents__link">Temperature and humidity sensor DHT11</a></li><li><a href="#mb7388-hrxl-sensor-dht11" class="table-of-contents__link">MB7388 HRXL sensor DHT11</a></li><li><a href="#lorawan" class="table-of-contents__link">LoRaWan</a></li></ul></li><li><a href="#create-a-docs-version" class="table-of-contents__link">Create a docs version</a></li><li><a href="#add-a-version-dropdown" class="table-of-contents__link">Add a Version Dropdown</a></li><li><a href="#update-an-existing-version" class="table-of-contents__link">Update an existing version</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/IoT/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/openwaternetwork" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/IoT/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/OpenWaterNetwork/IoT" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Open Water Network.</div></div></div></footer></div>
<script src="/IoT/assets/js/styles.284837e9.js"></script>
<script src="/IoT/assets/js/runtime~main.f88cf925.js"></script>
<script src="/IoT/assets/js/main.3d1ecd3c.js"></script>
<script src="/IoT/assets/js/1.10e6b60e.js"></script>
<script src="/IoT/assets/js/2.49a454c6.js"></script>
<script src="/IoT/assets/js/3.1d458317.js"></script>
<script src="/IoT/assets/js/1be78505.37867c24.js"></script>
<script src="/IoT/assets/js/49.f7c4dc10.js"></script>
<script src="/IoT/assets/js/935f2afb.50c35842.js"></script>
<script src="/IoT/assets/js/17896441.7537e30b.js"></script>
<script src="/IoT/assets/js/ec2c6eb7.f1cc12e9.js"></script>
</body>
</html>